<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MCMC Fit &mdash; SALT Model 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SALT" href="modules.html" />
    <link rel="prev" title="Introduction" href="general_usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/theme.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="general_usage.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="general_usage.html#using-the-model">Using the Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="general_usage.html#examples">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Fitting to Data</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">MCMC Fit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-fit-with-emcee">Example Fit with emcee</a></li>
<li class="toctree-l2"><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">SALT</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SALT Model</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">MCMC Fit</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/fitting.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mcmc-fit">
<h1>MCMC Fit<a class="headerlink" href="#mcmc-fit" title="Permalink to this heading"></a></h1>
<p>As a semi-analytical model, SALT is designed to compute spectral lines quickly.  When paired with a Monte Carlo sampler, one can constrain the SALT parameter space efficently to determine the properties of galactic outflows and the associated uncertainties.  In this tutorial, we fit SALT to the spectrum of a real galaxy using the Python based Monte Carlo ensemble sampler, emcee (Foreman-Mackey, Hogg, Lang &amp; Goodman 2012).  The goal is to sufficiently sample a likelihood function to quantify the best parameter fit and associated uncertainties.  For this tutorial, we assume a Gaussian likelihood function.  The fitting code is described below.</p>
<section id="example-fit-with-emcee">
<h2>Example Fit with emcee<a class="headerlink" href="#example-fit-with-emcee" title="Permalink to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.ndimage.filters</span> <span class="k">as</span> <span class="nn">g</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">emcee</span>
<span class="kn">import</span> <span class="nn">corner</span>

<span class="kn">from</span> <span class="nn">SALT2022_LineProfile</span> <span class="kn">import</span> <span class="n">Line_Profile</span>

<span class="k">def</span> <span class="nf">rebin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xnew</span><span class="p">):</span>
   <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
   <span class="n">ynew</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">ynew</span>

<span class="k">def</span> <span class="nf">lnlike</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">):</span>

   <span class="n">alpha</span><span class="p">,</span><span class="n">psi</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">v_0</span><span class="p">,</span> <span class="n">v_w</span><span class="p">,</span> <span class="n">f_c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">v_ap</span> <span class="o">=</span> <span class="n">pars</span>

   <span class="n">tau</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">tau</span>
   <span class="n">k</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">k</span>
   <span class="n">delta</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">+</span><span class="mf">2.0</span><span class="o">+</span><span class="n">delta</span>

   <span class="n">background</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">v_range</span><span class="p">)</span>

   <span class="n">OCCULTATION</span> <span class="o">=</span> <span class="kc">True</span>
   <span class="n">APERTURE</span> <span class="o">=</span> <span class="kc">True</span>

   <span class="n">flow_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;psi&#39;</span><span class="p">:</span><span class="n">psi</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span><span class="n">gamma</span><span class="p">,</span> <span class="s1">&#39;tau&#39;</span><span class="p">:</span><span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;v_0&#39;</span><span class="p">:</span><span class="n">v_0</span><span class="p">,</span> <span class="s1">&#39;v_w&#39;</span><span class="p">:</span><span class="n">v_w</span><span class="p">,</span> <span class="s1">&#39;v_ap&#39;</span><span class="p">:</span><span class="n">v_ap</span><span class="p">,</span> <span class="s1">&#39;f_c&#39;</span><span class="p">:</span><span class="n">f_c</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;delta&#39;</span><span class="p">:</span><span class="n">delta</span><span class="p">}</span>
   <span class="n">profile_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;abs_waves&#39;</span><span class="p">:[</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">],</span><span class="s1">&#39;abs_osc_strs&#39;</span><span class="p">:[</span><span class="mf">0.277</span><span class="p">,</span><span class="mf">.575</span><span class="p">],</span> <span class="s1">&#39;em_waves&#39;</span><span class="p">:[</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">],</span><span class="s1">&#39;em_osc_strs&#39;</span><span class="p">:[</span><span class="mf">0.277</span><span class="p">,</span><span class="mf">0.277</span><span class="p">,</span><span class="mf">0.575</span><span class="p">,</span><span class="mf">0.575</span><span class="p">],</span><span class="s1">&#39;res&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">],</span><span class="s1">&#39;fluor&#39;</span><span class="p">:[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">],</span><span class="s1">&#39;p_r&#39;</span><span class="p">:[</span><span class="mf">.1592</span><span class="p">,</span><span class="mf">.1592</span><span class="p">,</span><span class="mf">.6577</span><span class="p">,</span><span class="mf">.6577</span><span class="p">],</span><span class="s1">&#39;p_f&#39;</span><span class="p">:[</span><span class="mf">.8408</span><span class="p">,</span><span class="mf">.8408</span><span class="p">,</span><span class="mf">.3423</span><span class="p">,</span><span class="mf">.3423</span><span class="p">],</span><span class="s1">&#39;final_waves&#39;</span><span class="p">:[</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1194.5</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">,</span><span class="mf">1197.39</span><span class="p">],</span><span class="s1">&#39;line_num&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;v_obs&#39;</span><span class="p">:</span><span class="n">v_range</span><span class="p">,</span><span class="s1">&#39;lam_ref&#39;</span><span class="p">:</span><span class="n">lam_ref</span><span class="p">,</span> <span class="s1">&#39;APERTURE&#39;</span><span class="p">:</span><span class="n">APERTURE</span><span class="p">,</span><span class="s1">&#39;OCCULTATION&#39;</span><span class="p">:</span><span class="n">OCCULTATION</span><span class="p">}</span>

   <span class="n">model</span> <span class="o">=</span> <span class="n">Line_Profile</span><span class="p">(</span><span class="n">v_range</span><span class="p">,</span><span class="n">lam_ref</span><span class="p">,</span><span class="n">background</span><span class="p">,</span><span class="n">flow_parameters</span><span class="p">,</span><span class="n">profile_parameters</span><span class="p">)</span>
   <span class="n">model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">res</span><span class="p">))</span>
   <span class="n">model</span> <span class="o">=</span> <span class="n">rebin</span><span class="p">(</span><span class="n">v_range</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">v_obs</span><span class="p">)</span>

   <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y</span><span class="p">))):</span>
      <span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">yerr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">2.0</span>
      <span class="n">result</span> <span class="o">+=</span> <span class="p">(((</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">model</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mf">2.0</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span>
   <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.5</span><span class="o">*</span><span class="n">result</span>
   <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">lnprior</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
   <span class="n">alpha</span><span class="p">,</span><span class="n">psi</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">v_0</span><span class="p">,</span><span class="n">v_w</span><span class="p">,</span><span class="n">f_c</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="n">v_ap</span> <span class="o">=</span> <span class="n">pars</span>
   <span class="k">if</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">alpha</span><span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">psi</span><span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="ow">and</span> <span class="mf">0.5</span><span class="o">&lt;</span><span class="n">gamma</span><span class="o">&lt;</span><span class="mf">2.0</span> <span class="ow">and</span> <span class="o">-</span><span class="mi">2</span><span class="o">&lt;</span><span class="n">tau</span><span class="o">&lt;</span><span class="mi">3</span> <span class="ow">and</span> <span class="mf">2.0</span><span class="o">&lt;</span><span class="n">v_0</span><span class="o">&lt;</span><span class="mf">150.0</span> <span class="ow">and</span> <span class="mf">200.0</span><span class="o">&lt;</span><span class="n">v_w</span><span class="o">&lt;</span><span class="mf">2500.0</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">f_c</span><span class="o">&lt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="o">-</span><span class="mf">2.0</span><span class="o">&lt;</span><span class="n">k</span><span class="o">&lt;</span><span class="mf">2.0</span> <span class="ow">and</span> <span class="mf">0.5</span><span class="o">&lt;</span><span class="n">delta</span><span class="o">&lt;</span><span class="mf">8.0</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">v_ap</span><span class="o">&lt;</span><span class="mi">2500</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
   <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">Inf</span>

<span class="k">def</span> <span class="nf">lnprob</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">yerr</span><span class="p">):</span>
   <span class="n">lnp</span> <span class="o">=</span> <span class="n">lnprior</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
   <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">lnp</span><span class="p">):</span>
      <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">Inf</span>
   <span class="k">return</span> <span class="n">lnp</span> <span class="o">+</span> <span class="n">lnlike</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">yerr</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   <span class="n">sampler</span> <span class="o">=</span> <span class="n">emcee</span><span class="o">.</span><span class="n">EnsembleSampler</span><span class="p">(</span><span class="n">nwalkers</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">lnprob</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">flux</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">error</span><span class="p">)),</span> <span class="n">pool</span><span class="o">=</span><span class="n">Pool</span><span class="p">(</span><span class="n">max_workers</span> <span class="o">=</span> <span class="mi">25</span><span class="p">))</span>
   <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
   <span class="n">sampler</span><span class="o">.</span><span class="n">run_mcmc</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">steps</span><span class="p">);</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- </span><span class="si">%s</span><span class="s2"> seconds ---&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
   <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;chain_pars.txt&#39;</span><span class="p">,</span><span class="n">sampler</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)))</span>
   <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;max_likelihood_pars.txt&#39;</span><span class="p">,</span><span class="n">sampler</span><span class="o">.</span><span class="n">get_log_prob</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nwalkers</span><span class="p">)))</span>


<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;0911+1831.txt&#39;</span><span class="p">)</span>
<span class="n">v_obs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">lam_ref</span> <span class="o">=</span> <span class="mf">1193.28</span>
<span class="n">v_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v_obs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">v_obs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1500</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="mf">30.0</span><span class="o">/</span><span class="p">(</span><span class="n">v_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">ndim</span><span class="p">,</span> <span class="n">nwalkers</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3000</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nwalkers</span><span class="p">,</span><span class="n">ndim</span><span class="p">)</span>

<span class="n">p0</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.5</span><span class="o">+</span><span class="mf">.5</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mf">5.0</span><span class="o">-</span><span class="mf">2.0</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mf">98.</span> <span class="o">+</span><span class="mf">2.</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mf">600.0</span><span class="o">+</span><span class="mf">200.0</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="mf">4.0</span><span class="o">-</span><span class="mf">2.0</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mf">3.0</span><span class="o">-</span><span class="mf">1.5</span>
<span class="n">p0</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span> <span class="o">*</span> <span class="mf">600.0</span><span class="o">+</span><span class="mf">200.0</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
   <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this heading"></a></h2>
<p>Here we analyize the results of the model fitting.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.ndimage.filters</span> <span class="k">as</span> <span class="nn">g</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">SALT2022_LineProfile</span> <span class="kn">import</span> <span class="n">Line_Profile</span>

<span class="k">def</span> <span class="nf">rebin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xnew</span><span class="p">):</span>
   <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
   <span class="n">ynew</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">ynew</span>

<span class="c1"># get data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;0911+1831.txt&#39;</span><span class="p">)</span>
<span class="n">v_obs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">eu</span> <span class="o">=</span> <span class="n">flux</span><span class="o">+</span><span class="n">error</span>
<span class="n">ed</span> <span class="o">=</span> <span class="n">flux</span><span class="o">-</span><span class="n">error</span>

<span class="c1"># get chains</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;0911_chains.txt&#39;</span><span class="p">)</span>
<span class="n">ndim</span><span class="p">,</span> <span class="n">nwalkers</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3000</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">chain</span><span class="p">,(</span><span class="n">nwalkers</span><span class="p">,</span><span class="n">steps</span><span class="p">,</span><span class="n">ndim</span><span class="p">))</span>

<span class="c1"># collect chains</span>
<span class="n">alpha_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">psi_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">gamma_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">tau_chain</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">chain</span><span class="p">[:,:,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">v_0_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">v_w_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">f_c_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">k_chain</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">chain</span><span class="p">[:,:,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">delta_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">8</span><span class="p">]</span><span class="o">+</span><span class="n">chain</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mf">2.0</span>
<span class="n">v_ap_chain</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,:,</span><span class="mi">9</span><span class="p">]</span>

<span class="c1"># convert chains to arrays</span>
<span class="n">alpha_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">alpha_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">psi_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psi_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">gamma_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gamma_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">tau_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tau_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">v_0_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v_0_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">v_w_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v_w_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">f_c_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">f_c_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">k_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">k_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">delta_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">delta_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">v_ap_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v_ap_chain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1"># find best fit from likelihood samples</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;0911_likelihoods.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">bf_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">likelihood</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">likelihood</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">best_fit</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">psi_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">gamma_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">tau_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">v_0_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">v_w_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">f_c_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">k_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">delta_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">],</span><span class="n">v_ap_arr</span><span class="p">[</span><span class="n">bf_ind</span><span class="p">]]</span>

<span class="c1"># best fit SALT parameters</span>
<span class="n">alpha</span><span class="p">,</span><span class="n">psi</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">v_0</span><span class="p">,</span><span class="n">v_w</span><span class="p">,</span><span class="n">f_c</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="n">v_ap</span> <span class="o">=</span> <span class="n">best_fit</span>

<span class="c1"># compute SALT</span>
<span class="n">lam_ref</span> <span class="o">=</span> <span class="mf">1193.28</span>
<span class="n">v_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v_obs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">v_obs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1500</span><span class="p">)</span>
<span class="n">background</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">v_range</span><span class="p">)</span>
<span class="n">OCCULTATION</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">APERTURE</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">flow_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;psi&#39;</span><span class="p">:</span><span class="n">psi</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span><span class="n">gamma</span><span class="p">,</span> <span class="s1">&#39;tau&#39;</span><span class="p">:</span><span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;v_0&#39;</span><span class="p">:</span><span class="n">v_0</span><span class="p">,</span> <span class="s1">&#39;v_w&#39;</span><span class="p">:</span><span class="n">v_w</span><span class="p">,</span> <span class="s1">&#39;v_ap&#39;</span><span class="p">:</span><span class="n">v_ap</span><span class="p">,</span> <span class="s1">&#39;f_c&#39;</span><span class="p">:</span><span class="n">f_c</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;delta&#39;</span><span class="p">:</span><span class="n">delta</span><span class="p">}</span>
<span class="n">profile_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;abs_waves&#39;</span><span class="p">:[</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">],</span><span class="s1">&#39;abs_osc_strs&#39;</span><span class="p">:[</span><span class="mf">0.277</span><span class="p">,</span><span class="mf">.575</span><span class="p">],</span> <span class="s1">&#39;em_waves&#39;</span><span class="p">:[</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">],</span><span class="s1">&#39;em_osc_strs&#39;</span><span class="p">:[</span><span class="mf">0.277</span><span class="p">,</span><span class="mf">0.277</span><span class="p">,</span><span class="mf">0.575</span><span class="p">,</span><span class="mf">0.575</span><span class="p">],</span><span class="s1">&#39;res&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">],</span><span class="s1">&#39;fluor&#39;</span><span class="p">:[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">],</span><span class="s1">&#39;p_r&#39;</span><span class="p">:[</span><span class="mf">.1592</span><span class="p">,</span><span class="mf">.1592</span><span class="p">,</span><span class="mf">.6577</span><span class="p">,</span><span class="mf">.6577</span><span class="p">],</span><span class="s1">&#39;p_f&#39;</span><span class="p">:[</span><span class="mf">.8408</span><span class="p">,</span><span class="mf">.8408</span><span class="p">,</span><span class="mf">.3423</span><span class="p">,</span><span class="mf">.3423</span><span class="p">],</span><span class="s1">&#39;final_waves&#39;</span><span class="p">:[</span><span class="mf">1190.42</span><span class="p">,</span><span class="mf">1194.5</span><span class="p">,</span><span class="mf">1193.28</span><span class="p">,</span><span class="mf">1197.39</span><span class="p">],</span><span class="s1">&#39;line_num&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;v_obs&#39;</span><span class="p">:</span><span class="n">v_range</span><span class="p">,</span><span class="s1">&#39;lam_ref&#39;</span><span class="p">:</span><span class="n">lam_ref</span><span class="p">,</span> <span class="s1">&#39;APERTURE&#39;</span><span class="p">:</span><span class="n">APERTURE</span><span class="p">,</span><span class="s1">&#39;OCCULTATION&#39;</span><span class="p">:</span><span class="n">OCCULTATION</span><span class="p">}</span>
<span class="n">spectrum</span>  <span class="o">=</span> <span class="n">Line_Profile</span><span class="p">(</span><span class="n">v_range</span><span class="p">,</span><span class="n">lam_ref</span><span class="p">,</span><span class="n">background</span><span class="p">,</span><span class="n">flow_parameters</span><span class="p">,</span><span class="n">profile_parameters</span><span class="p">)</span>

<span class="c1"># smooth and rebin data</span>
<span class="n">res</span> <span class="o">=</span> <span class="mf">30.0</span><span class="o">/</span><span class="p">(</span><span class="n">v_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span><span class="n">res</span><span class="p">))</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">rebin</span><span class="p">(</span><span class="n">v_range</span><span class="p">,</span><span class="n">spectrum</span><span class="p">,</span><span class="n">v_obs</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">v_obs</span><span class="p">,</span> <span class="n">eu</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">v_obs</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_obs</span><span class="p">,</span><span class="n">spectrum</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SALT&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Velocity &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$[\rm km \ s^{-1}]$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$F/F_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">framealpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/res1.png"><img alt="result one" src="_images/res1.png" style="width: 700px;" /></a>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># show steps in parameter space</span>
<span class="n">fig</span><span class="p">,(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span><span class="p">,</span><span class="n">ax5</span><span class="p">,</span><span class="n">ax6</span><span class="p">,</span><span class="n">ax7</span><span class="p">,</span><span class="n">ax8</span><span class="p">,</span><span class="n">ax9</span><span class="p">,</span><span class="n">ax10</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">8.5</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">alpha_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">psi_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gamma_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tau_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_0_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_w_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_c_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax9</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">delta_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_ap_chain</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># alpha</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># psi</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># gamma</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># tau</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># v_0</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># v_w</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1500</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2500</span><span class="p">])</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1500</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2500</span><span class="p">])</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># f_c</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.75</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># kappa</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># delta</span>
<span class="n">ax9</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">ax9</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">ax9</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

<span class="c1"># v_ap</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1500</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2500</span><span class="p">])</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1500</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2500</span><span class="p">])</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\psi$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\gamma$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$v_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$v_{\infty}$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f_c$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\kappa$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax9</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$v_</span><span class="si">{ap}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span><span class="p">,</span><span class="n">ax5</span><span class="p">,</span><span class="n">ax6</span><span class="p">,</span><span class="n">ax7</span><span class="p">,</span><span class="n">ax8</span><span class="p">,</span><span class="n">ax9</span><span class="p">]:</span>
   <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Steps&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
   <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/res2.png"><img alt="result one" src="_images/res2.png" style="width: 700px;" /></a>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># marginal pdfs</span>
<span class="kn">import</span> <span class="nn">corner</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[:,</span><span class="mi">500</span><span class="p">:,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">corner</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\psi$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\gamma$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\tau$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$v_0$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$v_{\infty}$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$f_c$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\kappa$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\delta$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$v_</span><span class="si">{ap}</span><span class="s1">$&#39;</span><span class="p">],</span><span class="n">truths</span><span class="o">=</span><span class="p">[</span><span class="n">alpha</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">v_0</span><span class="p">,</span> <span class="n">v_w</span><span class="p">,</span> <span class="n">f_c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">v_ap</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;pdfs.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/res3.png"><img alt="result one" src="_images/res3.png" style="width: 700px;" /></a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="general_usage.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="SALT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Cody Carr.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>